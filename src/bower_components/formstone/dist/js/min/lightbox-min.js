!function(t,e,i){"use strict";function o(){N=e.$body,P=t("html, body")}function a(){B&&d()}function n(t){this.on(A.click,t,l)}function r(t){h(),this.off(A.namespace)}function g(e,i){e instanceof t&&l.apply(K,[{data:t.extend({},{$object:e},O,i||{})}])}function l(i){if(!B){var o=i.data,a=o.$el,n=o.$object,r=a&&a[0].href?a[0].href||"":"",g=a&&a[0].hash?a[0].hash||"":"",l=r.toLowerCase().split(".").pop().split(/\#|\?/),d=l[0],s=a?a.data(L+"-type"):"",c="image"===s||t.inArray(d,o.extensions)>-1||"data:image"===r.substr(0,10),p=r.indexOf("youtube.com/embed")>-1||r.indexOf("player.vimeo.com/video")>-1,H="url"===s||!c&&!p&&"http"===r.substr(0,4)&&!g,u="element"===s||!c&&!p&&!H&&"#"===g.substr(0,1),v="undefined"!=typeof n;if(u&&(r=g),!(c||p||H||u||v))return;if(E.killEvent(i),B=t.extend({},{visible:!1,gallery:{active:!1},isMobile:e.isMobile||o.mobile,isAnimating:!0,oldContentHeight:0,oldContentWidth:0},o),B.margin*=2,B.type=c?"image":p?"video":"element",c||p){var W=a.data(L+"-gallery");W&&(B.gallery.active=!0,B.gallery.id=W,B.gallery.$items=t("a[data-lightbox-gallery= "+B.gallery.id+"], a[rel= "+B.gallery.id+"]"),B.gallery.index=B.gallery.$items.index(B.$el),B.gallery.total=B.gallery.$items.length-1)}var b="";B.isMobile||(b+='<div class="'+[q.raw.overlay,B.customClass].join(" ")+'"></div>');var _=[q.raw.base,q.raw.loading,q.raw.animating,B.customClass];B.fixed&&_.push(q.raw.fixed),B.isMobile&&_.push(q.raw.mobile),H&&_.push(q.raw.iframed),(u||v)&&_.push(q.raw.inline),b+='<div class="'+_.join(" ")+'">',b+='<button type="button" class="'+q.raw.close+'">'+B.labels.close+"</button>",b+='<span class="'+q.raw.loading_icon+'"></span>',b+='<div class="'+q.raw.container+'">',b+='<div class="'+q.raw.content+'">',(c||p)&&(b+='<div class="'+q.raw.meta+'">',B.gallery.active&&(b+='<button type="button" class="'+[q.raw.control,q.raw.control_previous].join(" ")+'">'+B.labels.previous+"</button>",b+='<button type="button" class="'+[q.raw.control,q.raw.control_next].join(" ")+'">'+B.labels.next+"</button>",b+='<p class="'+q.raw.position+'"',B.gallery.total<1&&(b+=' style="display: none;"'),b+=">",b+='<span class="'+q.raw.position_current+'">'+(B.gallery.index+1)+"</span> ",b+=B.labels.count,b+=' <span class="'+q.raw.position_total+'">'+(B.gallery.total+1)+"</span>",b+="</p>"),b+='<div class="'+q.raw.caption+'">',b+=B.formatter.call(a,o),b+="</div></div>"),b+="</div></div></div>",N.append(b),B.$overlay=t(q.overlay),B.$lightbox=t(q.base),B.$close=t(q.close),B.$container=t(q.container),B.$content=t(q.content),B.$meta=t(q.meta),B.$position=t(q.position),B.$caption=t(q.caption),B.$controls=t(q.control),B.paddingVertical=B.isMobile?B.$close.outerHeight()/2:parseInt(B.$lightbox.css("paddingTop"),10)+parseInt(B.$lightbox.css("paddingBottom"),10),B.paddingHorizontal=B.isMobile?0:parseInt(B.$lightbox.css("paddingLeft"),10)+parseInt(B.$lightbox.css("paddingRight"),10),B.contentHeight=B.$lightbox.outerHeight()-B.paddingVertical,B.contentWidth=B.$lightbox.outerWidth()-B.paddingHorizontal,B.controlHeight=B.$controls.outerHeight(),m(),B.gallery.active&&x(),S.on(A.keyDown,I),N.on(A.clickTouchStart,[q.overlay,q.close].join(", "),h),B.gallery.active&&B.$lightbox.on(A.clickTouchStart,q.control,y),B.$lightbox.transition({property:"opacity"},function(){c?w(r):p?f(r):H?C(r):u?M(r):v&&V(B.$object)}).addClass(q.raw.open),B.$overlay.addClass(q.raw.open)}}function d(t){"object"!=typeof t&&(B.targetHeight=arguments[0],B.targetWidth=arguments[1]),"element"===B.type?_(B.$content.find("> :first-child")):"image"===B.type?u():"video"===B.type&&W(),c()}function h(t){E.killEvent(t),B&&(B.$lightbox.transition("destroy"),B.$container.transition("destroy"),B.$lightbox.addClass(q.raw.animating).transition({property:"opacity"},function(t){B.$lightbox.off(A.namespace),B.$container.off(A.namespace),S.off(A.namespace),N.off(A.namespace),B.$overlay.remove(),B.$lightbox.remove(),B=null,S.trigger(A.close)}),B.$lightbox.removeClass(q.raw.open),B.$overlay.removeClass(q.raw.open),B.isMobile&&P.removeClass(R.lock))}function s(){var t=p();B.isMobile?0:B.duration,B.isMobile||B.$controls.css({marginTop:(B.contentHeight-B.controlHeight-B.metaHeight)/2}),!B.visible&&B.isMobile&&B.gallery.active&&B.$content.touch({axis:"x",swipe:!0}).on(A.swipe,k),B.$lightbox.transition({property:B.contentHeight!==B.oldContentHeight?"height":"width"},function(){B.$container.transition({property:"opacity"},function(){B.$lightbox.removeClass(q.raw.animating),B.isAnimating=!1}),B.$lightbox.removeClass(q.raw.loading),B.visible=!0,S.trigger(A.open),B.gallery.active&&b()}),B.isMobile||B.$lightbox.css({height:B.contentHeight+B.paddingVertical,width:B.contentWidth+B.paddingHorizontal,top:B.fixed?0:t.top});var e=B.oldContentHeight!==B.contentHeight||B.oldContentWidth!==B.contentWidth;(B.isMobile||!e)&&B.$lightbox.transition("resolve"),B.oldContentHeight=B.contentHeight,B.oldContentWidth=B.contentWidth,B.isMobile&&P.addClass(R.lock)}function c(){if(B.visible&&!B.isMobile){var t=p();B.$controls.css({marginTop:(B.contentHeight-B.controlHeight-B.metaHeight)/2}),B.$lightbox.css({height:B.contentHeight+B.paddingVertical,width:B.contentWidth+B.paddingHorizontal,top:B.fixed?0:t.top})}}function m(){var t=p();B.$lightbox.css({top:B.fixed?0:t.top})}function p(){if(B.isMobile)return{left:0,top:0};var t={left:(e.windowWidth-B.contentWidth-B.paddingHorizontal)/2,top:B.top<=0?(e.windowHeight-B.contentHeight-B.paddingVertical)/2:B.top};return B.fixed!==!0&&(t.top+=S.scrollTop()),t}function H(){var t=this.attr("title"),e=t!==i&&t?t.replace(/^\s+|\s+$/g,""):!1;return e?'<p class="caption">'+e+"</p>":""}function w(e){B.$image=t("<img>"),B.$image.one(A.load,function(){var t=z(B.$image);B.naturalHeight=t.naturalHeight,B.naturalWidth=t.naturalWidth,B.retina&&(B.naturalHeight/=2,B.naturalWidth/=2),B.$content.prepend(B.$image),""===B.$caption.html()?B.$caption.hide():B.$caption.show(),u(),s()}).error(j).attr("src",e).addClass(q.raw.image),(B.$image[0].complete||4===B.$image[0].readyState)&&B.$image.trigger(A.load)}function u(){var t=0;for(B.windowHeight=B.viewportHeight=e.windowHeight-B.paddingVertical,B.windowWidth=B.viewportWidth=e.windowWidth-B.paddingHorizontal,B.contentHeight=1/0,B.contentWidth=1/0,B.imageMarginTop=0,B.imageMarginLeft=0;B.contentHeight>B.viewportHeight&&2>t;)B.imageHeight=0===t?B.naturalHeight:B.$image.outerHeight(),B.imageWidth=0===t?B.naturalWidth:B.$image.outerWidth(),B.metaHeight=0===t?0:B.metaHeight,0===t&&(B.ratioHorizontal=B.imageHeight/B.imageWidth,B.ratioVertical=B.imageWidth/B.imageHeight,B.isWide=B.imageWidth>B.imageHeight),B.imageHeight<B.minHeight&&(B.minHeight=B.imageHeight),B.imageWidth<B.minWidth&&(B.minWidth=B.imageWidth),B.isMobile?(B.$meta.css({width:B.windowWidth}),B.metaHeight=B.$meta.outerHeight(!0),B.contentHeight=B.viewportHeight-B.paddingVertical,B.contentWidth=B.viewportWidth-B.paddingHorizontal,v(),B.imageMarginTop=(B.contentHeight-B.targetImageHeight-B.metaHeight)/2,B.imageMarginLeft=(B.contentWidth-B.targetImageWidth)/2):(0===t&&(B.viewportHeight-=B.margin+B.paddingVertical,B.viewportWidth-=B.margin+B.paddingHorizontal),B.viewportHeight-=B.metaHeight,v(),B.contentHeight=B.targetImageHeight,B.contentWidth=B.targetImageWidth),B.$meta.css({width:B.contentWidth}),B.$image.css({height:B.targetImageHeight,width:B.targetImageWidth,marginTop:B.imageMarginTop,marginLeft:B.imageMarginLeft}),B.isMobile||(B.metaHeight=B.$meta.outerHeight(!0),B.contentHeight+=B.metaHeight),t++}function v(){var t=B.isMobile?B.contentHeight-B.metaHeight:B.viewportHeight,e=B.isMobile?B.contentWidth:B.viewportWidth;B.isWide?(B.targetImageWidth=e,B.targetImageHeight=B.targetImageWidth*B.ratioHorizontal,B.targetImageHeight>t&&(B.targetImageHeight=t,B.targetImageWidth=B.targetImageHeight*B.ratioVertical)):(B.targetImageHeight=t,B.targetImageWidth=B.targetImageHeight*B.ratioVertical,B.targetImageWidth>e&&(B.targetImageWidth=e,B.targetImageHeight=B.targetImageWidth*B.ratioHorizontal)),(B.targetImageWidth>B.imageWidth||B.targetImageHeight>B.imageHeight)&&(B.targetImageHeight=B.imageHeight,B.targetImageWidth=B.imageWidth),(B.targetImageWidth<B.minWidth||B.targetImageHeight<B.minHeight)&&(B.targetImageWidth<B.minWidth?(B.targetImageWidth=B.minWidth,B.targetImageHeight=B.targetImageWidth*B.ratioHorizontal):(B.targetImageHeight=B.minHeight,B.targetImageWidth=B.targetImageHeight*B.ratioVertical))}function f(e){B.$videoWrapper=t('<div class="'+q.raw.videoWrapper+'"></div>'),B.$video=t('<iframe class="'+q.raw.video+'" seamless="seamless"></iframe>'),B.$video.attr("src",e).addClass(q.raw.video).prependTo(B.$videoWrapper),B.$content.prepend(B.$videoWrapper),W(),s()}function W(){B.windowHeight=B.viewportHeight=B.contentHeight=e.windowHeight-B.paddingVertical,B.windowWidth=B.viewportWidth=B.contentWidth=e.windowWidth-B.paddingHorizontal,B.videoMarginTop=0,B.videoMarginLeft=0,B.isMobile?(B.$meta.css({width:B.windowWidth}),B.metaHeight=B.$meta.outerHeight(!0),B.viewportHeight-=B.metaHeight,B.targetVideoWidth=B.viewportWidth,B.targetVideoHeight=B.targetVideoWidth*B.videoRatio,B.targetVideoHeight>B.viewportHeight&&(B.targetVideoHeight=B.viewportHeight,B.targetVideoWidth=B.targetVideoHeight/B.videoRatio),B.videoMarginTop=(B.viewportHeight-B.targetVideoHeight)/2,B.videoMarginLeft=(B.viewportWidth-B.targetVideoWidth)/2):(B.viewportHeight=B.windowHeight-B.margin,B.viewportWidth=B.windowWidth-B.margin,B.targetVideoWidth=B.videoWidth>B.viewportWidth?B.viewportWidth:B.videoWidth,B.targetVideoWidth<B.minWidth&&(B.targetVideoWidth=B.minWidth),B.targetVideoHeight=B.targetVideoWidth*B.videoRatio,B.contentHeight=B.targetVideoHeight,B.contentWidth=B.targetVideoWidth),B.$meta.css({width:B.contentWidth}),B.$videoWrapper.css({height:B.targetVideoHeight,width:B.targetVideoWidth,marginTop:B.videoMarginTop,marginLeft:B.videoMarginLeft}),B.isMobile||(B.metaHeight=B.$meta.outerHeight(!0),B.contentHeight=B.targetVideoHeight+B.metaHeight)}function b(e){var i="";B.gallery.index>0&&(i=B.gallery.$items.eq(B.gallery.index-1).attr("href"),i.indexOf("youtube.com/embed")<0&&i.indexOf("player.vimeo.com/video")<0&&t('<img src="'+i+'">')),B.gallery.index<B.gallery.total&&(i=B.gallery.$items.eq(B.gallery.index+1).attr("href"),i.indexOf("youtube.com/embed")<0&&i.indexOf("player.vimeo.com/video")<0&&t('<img src="'+i+'">'))}function y(e){E.killEvent(e);var i=t(e.currentTarget);B.isAnimating||i.hasClass(q.raw.control_disabled)||(B.isAnimating=!0,B.gallery.index+=i.hasClass(q.raw.control_next)?1:-1,B.gallery.index>B.gallery.total&&(B.gallery.index=B.infinite?0:B.gallery.total),B.gallery.index<0&&(B.gallery.index=B.infinite?B.gallery.total:0),B.$lightbox.addClass([q.raw.loading,q.raw.animating].join(" ")),B.$container.transition({property:"opacity"},function(){"undefined"!=typeof B.$image&&B.$image.remove(),"undefined"!=typeof B.$videoWrapper&&B.$videoWrapper.remove(),B.$el=B.gallery.$items.eq(B.gallery.index),B.$caption.html(B.formatter.call(B.$el,B)),B.$position.find(q.position_current).html(B.gallery.index+1);var t=B.$el.attr("href"),e=t.indexOf("youtube.com/embed")>-1||t.indexOf("player.vimeo.com/video")>-1;e?f(t):w(t),x()}))}function x(){B.$controls.removeClass(q.raw.control_disabled),B.infinite||(0===B.gallery.index&&B.$controls.filter(q.control_previous).addClass(R.control_disabled),B.gallery.index===B.gallery.total&&B.$controls.filter(q.control_next).addClass(R.control_disabled))}function I(t){!B.gallery.active||37!==t.keyCode&&39!==t.keyCode?27===t.keyCode&&B.$close.trigger(A.click):(E.killEvent(t),B.$controls.filter(37===t.keyCode?q.control_previous:q.control_next).trigger(A.click))}function M(e){var i=t(e).find("> :first-child").clone();V(i)}function C(e){e+=e.indexOf("?")>-1?"&"+B.requestKey+"=true":"?"+B.requestKey+"=true";var i=t('<iframe class="'+q.raw.iframe+'" src="'+e+'"></iframe>');V(i)}function V(t){B.$content.append(t),_(t),s()}function _(t){B.windowHeight=e.windowHeight-B.paddingVertical,B.windowWidth=e.windowWidth-B.paddingHorizontal,B.objectHeight=t.outerHeight(!0),B.objectWidth=t.outerWidth(!0),B.targetHeight=B.targetHeight||(B.$el?B.$el.data(L+"-height"):null),B.targetWidth=B.targetWidth||(B.$el?B.$el.data(L+"-width"):null),B.maxHeight=B.windowHeight<0?B.minHeight:B.windowHeight,B.isIframe=t.is("iframe"),B.objectMarginTop=0,B.objectMarginLeft=0,B.isMobile||(B.windowHeight-=B.margin,B.windowWidth-=B.margin),B.contentHeight=B.targetHeight?B.targetHeight:B.isIframe||B.isMobile?B.windowHeight:B.objectHeight,B.contentWidth=B.targetWidth?B.targetWidth:B.isIframe||B.isMobile?B.windowWidth:B.objectWidth,(B.isIframe||B.isObject)&&B.isMobile?(B.contentHeight=B.windowHeight,B.contentWidth=B.windowWidth):B.isObject&&(B.contentHeight=B.contentHeight>B.windowHeight?B.windowHeight:B.contentHeight,B.contentWidth=B.contentWidth>B.windowWidth?B.windowWidth:B.contentWidth)}function j(e){var i=t('<div class="'+q.raw.error+'"><p>Error Loading Resource</p></div>');B.type="element",B.$meta.remove(),B.$image.off(A.namespace),V(i)}function k(t){B.$controls.filter("left"===t.directionX?q.control_next:q.control_previous).trigger(A.click)}function z(t){var e=t[0],i=new Image;return"undefined"!=typeof e.naturalHeight?{naturalHeight:e.naturalHeight,naturalWidth:e.naturalWidth}:"img"===e.tagName.toLowerCase()?(i.src=e.src,{naturalHeight:i.height,naturalWidth:i.width}):!1}var T=e.Plugin("lightbox",{widget:!0,defaults:{customClass:"",extensions:["jpg","sjpg","jpeg","png","gif"],fixed:!1,formatter:H,infinite:!1,labels:{close:"Close",count:"of",next:"Next",previous:"Previous"},margin:50,minHeight:100,minWidth:100,mobile:!1,retina:!1,requestKey:"fs-lightbox",top:0,videoRatio:.5625,videoWidth:600},classes:["loading","animating","fixed","mobile","inline","iframed","open","overlay","close","loading_icon","container","content","image","video","video_wrapper","meta","control","control_previous","control_next","control_disabled","position","position_current","position_total","caption","iframe","error","lock"],events:{open:"open",close:"close",swipe:"swipe"},methods:{_setup:o,_construct:n,_destruct:r,_resize:a,resize:d},utilities:{_initialize:g,close:h}}),L=T.namespace,O=T.defaults,q=T.classes,R=q.raw,A=T.events,E=T.functions,K=e.window,S=e.$window,N=null,P=null,B=null}(jQuery,Formstone);