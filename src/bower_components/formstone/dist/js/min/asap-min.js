!function(e,t,r){"use strict";function n(r){w||t.support.history&&(p=t.$body,w=e.extend(y,r),w.$container=e(w.container),w.render===e.noop&&(w.render=u),w.transitionOut===e.noop&&(w.transitionOut=function(){return e.Deferred().resolve()}),L=window.location.href,m.on(k.popState,s),a())}function a(){p&&!p.hasClass(b.base)&&p.on(k.click,y.selector,i).addClass(b.base)}function o(e){w&&t.support.history?e&&l(e):window.location.href=e}function i(e){var t=e.currentTarget;e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||window.location.protocol!==t.protocol||window.location.host!==t.host||"_blank"===t.target||(!t.hash||t.href.replace(t.hash,"")!==window.location.href.replace(location.hash,"")&&t.href!==window.location.href+"#")&&(q.killEvent(e),e.stopImmediatePropagation(),t.href===L||l(t.href))}function s(e){var t=e.originalEvent.state;t&&(w.modal&&0===j&&t.url&&!t.initial?window.location.href=t.url:t.url!==L&&(w.force?l(t.url):(m.trigger(k.request,[!0]),c(t.url,t.hash,t.data,t.scroll,!1))))}function l(t){g&&g.abort(),m.trigger(k.request,[!1]),w.transitionOutDeferred=w.transitionOut.apply(O,[!1]);var r=t.indexOf("?"),n=t.indexOf("#"),a={},o="",i=t,s="User error",l=null,u=e.Deferred();n>-1&&(o=t.slice(n),i=t.slice(0,n)),r>-1&&(a=h(t.slice(r+1,n>-1?n:t.length)),i=t.slice(0,r)),a[w.requestKey]=!0,g=e.ajax({url:i,data:a,dataType:"json",cache:w.cache,xhr:function(){var e=new O.XMLHttpRequest;return e.addEventListener("progress",function(e){if(e.lengthComputable){var t=e.loaded/e.total;m.trigger(k.progress,[t])}},!1),e},success:function(r,n,a){l="string"===e.type(r)?e.parseJSON(r):r,r.location&&(t=r.location),u.resolve()},error:function(e,t,r){s=r,u.reject()}}),e.when(u,w.transitionOutDeferred).done(function(){c(t,o,l,w.jump?0:!1,!0)}).fail(function(){m.trigger(k.error,[s])})}function c(t,r,n,a,o){if(m.trigger(k.load,[n]),d(t),f(n),w.render.call(this,n,r),L=t,o?(history.pushState({url:L,data:n,scroll:a,hash:r},"state-"+L,L),j++):f(n),m.trigger(k.render,[n]),""!==r){var i=e(r);i.length&&(a=i.offset().top)}a!==!1&&m.scrollTop(a)}function u(t,r){if("undefined"!==e.type(t)){var n;for(var a in t)t.hasOwnProperty(a)&&(n=e(a),n.length&&n.html(t[a]))}}function f(t){var r=[];if("undefined"!==e.type(t)){var n;for(var a in t)t.hasOwnProperty(a)&&(n=e(a),n.length&&(r[a]=n.html()))}history.replaceState({url:L,data:r,scroll:m.scrollTop()},"state-"+L,L)}function d(e){if(e=e.replace(window.location.protocol+"//"+window.location.host,""),w.tracking.legacy)O._gaq=O._gaq||[],O._gaq.push(["_trackPageview",e]);else if(w.tracking.manager){var t={};t[w.tracking.variable]=e,O.dataLayer=window.dataLayer||[],O.dataLayer.push(t),O.dataLayer.push({event:w.tracking.event})}}function h(e){for(var t={},r=e.slice(e.indexOf("?")+1).split("&"),n=0;n<r.length;n++){var a=r[n].split("=");t[a[0]]=a[1]}return t}var p,g,w,v=t.Plugin("asap",{utilities:{_initialize:n,load:o},events:{popState:"popstate",request:"request",render:"render"}}),y={cache:!0,force:!1,jump:!0,modal:!1,selector:"a",render:e.noop,requestKey:"fs-asap",tracking:{legacy:!1,manager:!1,variable:"currentURL",event:"PageView"},transitionOut:e.noop},m=t.$window,O=m[0],q=v.functions,k=v.events,b=v.classes.raw,L="",j=0}(jQuery,Formstone);