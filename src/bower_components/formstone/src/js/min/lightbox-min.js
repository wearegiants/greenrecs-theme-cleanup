!function($,t,e){"use strict";function i(){S=t.$body,N=$("html, body")}function o(){P&&l()}function a(t){this.on(R.click,t,g)}function n(t){d(),this.off(R.namespace)}function r(t,e){t instanceof $&&g.apply(E,[{data:$.extend({},{$object:t},L,e||{})}])}function g(e){if(!P){var i=e.data,o=i.$el,a=i.$object,n=o&&o[0].href?o[0].href||"":"",r=o&&o[0].hash?o[0].hash||"":"",g=n.toLowerCase().split(".").pop().split(/\#|\?/),l=g[0],h=o?o.data(T+"-type"):"",s="image"===h||$.inArray(l,i.extensions)>-1||"data:image"===n.substr(0,10),m=n.indexOf("youtube.com/embed")>-1||n.indexOf("player.vimeo.com/video")>-1,p="url"===h||!s&&!m&&"http"===n.substr(0,4)&&!r,w="element"===h||!s&&!m&&!p&&"#"===r.substr(0,1),u="undefined"!=typeof a;if(w&&(n=r),!(s||m||p||w||u))return;if(A.killEvent(e),P=$.extend({},{visible:!1,gallery:{active:!1},isMobile:t.isMobile||i.mobile,isAnimating:!0,oldContentHeight:0,oldContentWidth:0},i),P.margin*=2,P.type=s?"image":m?"video":"element",s||m){var f=o.data(T+"-gallery");f&&(P.gallery.active=!0,P.gallery.id=f,P.gallery.$items=$("a[data-lightbox-gallery= "+P.gallery.id+"], a[rel= "+P.gallery.id+"]"),P.gallery.index=P.gallery.$items.index(P.$el),P.gallery.total=P.gallery.$items.length-1)}var W="";P.isMobile||(W+='<div class="'+[O.raw.overlay,P.customClass].join(" ")+'"></div>');var V=[O.raw.base,O.raw.loading,O.raw.animating,P.customClass];P.fixed&&V.push(O.raw.fixed),P.isMobile&&V.push(O.raw.mobile),p&&V.push(O.raw.iframed),(w||u)&&V.push(O.raw.inline),W+='<div class="'+V.join(" ")+'">',W+='<button type="button" class="'+O.raw.close+'">'+P.labels.close+"</button>",W+='<span class="'+O.raw.loading_icon+'"></span>',W+='<div class="'+O.raw.container+'">',W+='<div class="'+O.raw.content+'">',(s||m)&&(W+='<div class="'+O.raw.meta+'">',P.gallery.active&&(W+='<button type="button" class="'+[O.raw.control,O.raw.control_previous].join(" ")+'">'+P.labels.previous+"</button>",W+='<button type="button" class="'+[O.raw.control,O.raw.control_next].join(" ")+'">'+P.labels.next+"</button>",W+='<p class="'+O.raw.position+'"',P.gallery.total<1&&(W+=' style="display: none;"'),W+=">",W+='<span class="'+O.raw.position_current+'">'+(P.gallery.index+1)+"</span> ",W+=P.labels.count,W+=' <span class="'+O.raw.position_total+'">'+(P.gallery.total+1)+"</span>",W+="</p>"),W+='<div class="'+O.raw.caption+'">',W+=P.formatter.call(o,i),W+="</div></div>"),W+="</div></div></div>",S.append(W),P.$overlay=$(O.overlay),P.$lightbox=$(O.base),P.$close=$(O.close),P.$container=$(O.container),P.$content=$(O.content),P.$meta=$(O.meta),P.$position=$(O.position),P.$caption=$(O.caption),P.$controls=$(O.control),P.paddingVertical=P.isMobile?P.$close.outerHeight()/2:parseInt(P.$lightbox.css("paddingTop"),10)+parseInt(P.$lightbox.css("paddingBottom"),10),P.paddingHorizontal=P.isMobile?0:parseInt(P.$lightbox.css("paddingLeft"),10)+parseInt(P.$lightbox.css("paddingRight"),10),P.contentHeight=P.$lightbox.outerHeight()-P.paddingVertical,P.contentWidth=P.$lightbox.outerWidth()-P.paddingHorizontal,P.controlHeight=P.$controls.outerHeight(),c(),P.gallery.active&&y(),K.on(R.keyDown,x),S.on(R.clickTouchStart,[O.overlay,O.close].join(", "),d),P.gallery.active&&P.$lightbox.on(R.clickTouchStart,O.control,b),P.$lightbox.transition({property:"opacity"},function(){s?H(n):m?v(n):p?M(n):w?I(n):u&&C(P.$object)}).addClass(O.raw.open),P.$overlay.addClass(O.raw.open)}}function l(t){"object"!=typeof t&&(P.targetHeight=arguments[0],P.targetWidth=arguments[1]),"element"===P.type?V(P.$content.find("> :first-child")):"image"===P.type?w():"video"===P.type&&f(),s()}function d(t){A.killEvent(t),P&&(P.$lightbox.transition("destroy"),P.$container.transition("destroy"),P.$lightbox.addClass(O.raw.animating).transition({property:"opacity"},function(t){P.$lightbox.off(R.namespace),P.$container.off(R.namespace),K.off(R.namespace),S.off(R.namespace),P.$overlay.remove(),P.$lightbox.remove(),P=null,K.trigger(R.close)}),P.$lightbox.removeClass(O.raw.open),P.$overlay.removeClass(O.raw.open),P.isMobile&&N.removeClass(q.lock))}function h(){var t=m(),e=P.isMobile?0:P.duration;P.isMobile||P.$controls.css({marginTop:(P.contentHeight-P.controlHeight-P.metaHeight)/2}),!P.visible&&P.isMobile&&P.gallery.active&&P.$content.touch({axis:"x",swipe:!0}).on(R.swipe,j),P.$lightbox.transition({property:P.contentHeight!==P.oldContentHeight?"height":"width"},function(){P.$container.transition({property:"opacity"},function(){P.$lightbox.removeClass(O.raw.animating),P.isAnimating=!1}),P.$lightbox.removeClass(O.raw.loading),P.visible=!0,K.trigger(R.open),P.gallery.active&&W()}),P.isMobile||P.$lightbox.css({height:P.contentHeight+P.paddingVertical,width:P.contentWidth+P.paddingHorizontal,top:P.fixed?0:t.top});var i=P.oldContentHeight!==P.contentHeight||P.oldContentWidth!==P.contentWidth;(P.isMobile||!i)&&P.$lightbox.transition("resolve"),P.oldContentHeight=P.contentHeight,P.oldContentWidth=P.contentWidth,P.isMobile&&N.addClass(q.lock)}function s(){if(P.visible&&!P.isMobile){var t=m();P.$controls.css({marginTop:(P.contentHeight-P.controlHeight-P.metaHeight)/2}),P.$lightbox.css({height:P.contentHeight+P.paddingVertical,width:P.contentWidth+P.paddingHorizontal,top:P.fixed?0:t.top})}}function c(){var t=m();P.$lightbox.css({top:P.fixed?0:t.top})}function m(){if(P.isMobile)return{left:0,top:0};var e={left:(t.windowWidth-P.contentWidth-P.paddingHorizontal)/2,top:P.top<=0?(t.windowHeight-P.contentHeight-P.paddingVertical)/2:P.top};return P.fixed!==!0&&(e.top+=K.scrollTop()),e}function p(){var t=this.attr("title"),i=t!==e&&t?t.replace(/^\s+|\s+$/g,""):!1;return i?'<p class="caption">'+i+"</p>":""}function H(t){P.$image=$("<img>"),P.$image.one(R.load,function(){var t=k(P.$image);P.naturalHeight=t.naturalHeight,P.naturalWidth=t.naturalWidth,P.retina&&(P.naturalHeight/=2,P.naturalWidth/=2),P.$content.prepend(P.$image),""===P.$caption.html()?P.$caption.hide():P.$caption.show(),w(),h()}).error(_).attr("src",t).addClass(O.raw.image),(P.$image[0].complete||4===P.$image[0].readyState)&&P.$image.trigger(R.load)}function w(){var e=0;for(P.windowHeight=P.viewportHeight=t.windowHeight-P.paddingVertical,P.windowWidth=P.viewportWidth=t.windowWidth-P.paddingHorizontal,P.contentHeight=1/0,P.contentWidth=1/0,P.imageMarginTop=0,P.imageMarginLeft=0;P.contentHeight>P.viewportHeight&&2>e;)P.imageHeight=0===e?P.naturalHeight:P.$image.outerHeight(),P.imageWidth=0===e?P.naturalWidth:P.$image.outerWidth(),P.metaHeight=0===e?0:P.metaHeight,0===e&&(P.ratioHorizontal=P.imageHeight/P.imageWidth,P.ratioVertical=P.imageWidth/P.imageHeight,P.isWide=P.imageWidth>P.imageHeight),P.imageHeight<P.minHeight&&(P.minHeight=P.imageHeight),P.imageWidth<P.minWidth&&(P.minWidth=P.imageWidth),P.isMobile?(P.$meta.css({width:P.windowWidth}),P.metaHeight=P.$meta.outerHeight(!0),P.contentHeight=P.viewportHeight-P.paddingVertical,P.contentWidth=P.viewportWidth-P.paddingHorizontal,u(),P.imageMarginTop=(P.contentHeight-P.targetImageHeight-P.metaHeight)/2,P.imageMarginLeft=(P.contentWidth-P.targetImageWidth)/2):(0===e&&(P.viewportHeight-=P.margin+P.paddingVertical,P.viewportWidth-=P.margin+P.paddingHorizontal),P.viewportHeight-=P.metaHeight,u(),P.contentHeight=P.targetImageHeight,P.contentWidth=P.targetImageWidth),P.$meta.css({width:P.contentWidth}),P.$image.css({height:P.targetImageHeight,width:P.targetImageWidth,marginTop:P.imageMarginTop,marginLeft:P.imageMarginLeft}),P.isMobile||(P.metaHeight=P.$meta.outerHeight(!0),P.contentHeight+=P.metaHeight),e++}function u(){var t=P.isMobile?P.contentHeight-P.metaHeight:P.viewportHeight,e=P.isMobile?P.contentWidth:P.viewportWidth;P.isWide?(P.targetImageWidth=e,P.targetImageHeight=P.targetImageWidth*P.ratioHorizontal,P.targetImageHeight>t&&(P.targetImageHeight=t,P.targetImageWidth=P.targetImageHeight*P.ratioVertical)):(P.targetImageHeight=t,P.targetImageWidth=P.targetImageHeight*P.ratioVertical,P.targetImageWidth>e&&(P.targetImageWidth=e,P.targetImageHeight=P.targetImageWidth*P.ratioHorizontal)),(P.targetImageWidth>P.imageWidth||P.targetImageHeight>P.imageHeight)&&(P.targetImageHeight=P.imageHeight,P.targetImageWidth=P.imageWidth),(P.targetImageWidth<P.minWidth||P.targetImageHeight<P.minHeight)&&(P.targetImageWidth<P.minWidth?(P.targetImageWidth=P.minWidth,P.targetImageHeight=P.targetImageWidth*P.ratioHorizontal):(P.targetImageHeight=P.minHeight,P.targetImageWidth=P.targetImageHeight*P.ratioVertical))}function v(t){P.$videoWrapper=$('<div class="'+O.raw.videoWrapper+'"></div>'),P.$video=$('<iframe class="'+O.raw.video+'" seamless="seamless"></iframe>'),P.$video.attr("src",t).addClass(O.raw.video).prependTo(P.$videoWrapper),P.$content.prepend(P.$videoWrapper),f(),h()}function f(){P.windowHeight=P.viewportHeight=P.contentHeight=t.windowHeight-P.paddingVertical,P.windowWidth=P.viewportWidth=P.contentWidth=t.windowWidth-P.paddingHorizontal,P.videoMarginTop=0,P.videoMarginLeft=0,P.isMobile?(P.$meta.css({width:P.windowWidth}),P.metaHeight=P.$meta.outerHeight(!0),P.viewportHeight-=P.metaHeight,P.targetVideoWidth=P.viewportWidth,P.targetVideoHeight=P.targetVideoWidth*P.videoRatio,P.targetVideoHeight>P.viewportHeight&&(P.targetVideoHeight=P.viewportHeight,P.targetVideoWidth=P.targetVideoHeight/P.videoRatio),P.videoMarginTop=(P.viewportHeight-P.targetVideoHeight)/2,P.videoMarginLeft=(P.viewportWidth-P.targetVideoWidth)/2):(P.viewportHeight=P.windowHeight-P.margin,P.viewportWidth=P.windowWidth-P.margin,P.targetVideoWidth=P.videoWidth>P.viewportWidth?P.viewportWidth:P.videoWidth,P.targetVideoWidth<P.minWidth&&(P.targetVideoWidth=P.minWidth),P.targetVideoHeight=P.targetVideoWidth*P.videoRatio,P.contentHeight=P.targetVideoHeight,P.contentWidth=P.targetVideoWidth),P.$meta.css({width:P.contentWidth}),P.$videoWrapper.css({height:P.targetVideoHeight,width:P.targetVideoWidth,marginTop:P.videoMarginTop,marginLeft:P.videoMarginLeft}),P.isMobile||(P.metaHeight=P.$meta.outerHeight(!0),P.contentHeight=P.targetVideoHeight+P.metaHeight)}function W(t){var e="";P.gallery.index>0&&(e=P.gallery.$items.eq(P.gallery.index-1).attr("href"),e.indexOf("youtube.com/embed")<0&&e.indexOf("player.vimeo.com/video")<0&&$('<img src="'+e+'">')),P.gallery.index<P.gallery.total&&(e=P.gallery.$items.eq(P.gallery.index+1).attr("href"),e.indexOf("youtube.com/embed")<0&&e.indexOf("player.vimeo.com/video")<0&&$('<img src="'+e+'">'))}function b(t){A.killEvent(t);var e=$(t.currentTarget);P.isAnimating||e.hasClass(O.raw.control_disabled)||(P.isAnimating=!0,P.gallery.index+=e.hasClass(O.raw.control_next)?1:-1,P.gallery.index>P.gallery.total&&(P.gallery.index=P.infinite?0:P.gallery.total),P.gallery.index<0&&(P.gallery.index=P.infinite?P.gallery.total:0),P.$lightbox.addClass([O.raw.loading,O.raw.animating].join(" ")),P.$container.transition({property:"opacity"},function(){"undefined"!=typeof P.$image&&P.$image.remove(),"undefined"!=typeof P.$videoWrapper&&P.$videoWrapper.remove(),P.$el=P.gallery.$items.eq(P.gallery.index),P.$caption.html(P.formatter.call(P.$el,P)),P.$position.find(O.position_current).html(P.gallery.index+1);var t=P.$el.attr("href"),e=t.indexOf("youtube.com/embed")>-1||t.indexOf("player.vimeo.com/video")>-1;e?v(t):H(t),y()}))}function y(){P.$controls.removeClass(O.raw.control_disabled),P.infinite||(0===P.gallery.index&&P.$controls.filter(O.control_previous).addClass(q.control_disabled),P.gallery.index===P.gallery.total&&P.$controls.filter(O.control_next).addClass(q.control_disabled))}function x(t){!P.gallery.active||37!==t.keyCode&&39!==t.keyCode?27===t.keyCode&&P.$close.trigger(R.click):(A.killEvent(t),P.$controls.filter(37===t.keyCode?O.control_previous:O.control_next).trigger(R.click))}function I(t){var e=$(t).find("> :first-child").clone();C(e)}function M(t){t+=t.indexOf("?")>-1?"&"+P.requestKey+"=true":"?"+P.requestKey+"=true";var e=$('<iframe class="'+O.raw.iframe+'" src="'+t+'"></iframe>');C(e)}function C(t){P.$content.append(t),V(t),h()}function V(e){P.windowHeight=t.windowHeight-P.paddingVertical,P.windowWidth=t.windowWidth-P.paddingHorizontal,P.objectHeight=e.outerHeight(!0),P.objectWidth=e.outerWidth(!0),P.targetHeight=P.targetHeight||(P.$el?P.$el.data(T+"-height"):null),P.targetWidth=P.targetWidth||(P.$el?P.$el.data(T+"-width"):null),P.maxHeight=P.windowHeight<0?P.minHeight:P.windowHeight,P.isIframe=e.is("iframe"),P.objectMarginTop=0,P.objectMarginLeft=0,P.isMobile||(P.windowHeight-=P.margin,P.windowWidth-=P.margin),P.contentHeight=P.targetHeight?P.targetHeight:P.isIframe||P.isMobile?P.windowHeight:P.objectHeight,P.contentWidth=P.targetWidth?P.targetWidth:P.isIframe||P.isMobile?P.windowWidth:P.objectWidth,(P.isIframe||P.isObject)&&P.isMobile?(P.contentHeight=P.windowHeight,P.contentWidth=P.windowWidth):P.isObject&&(P.contentHeight=P.contentHeight>P.windowHeight?P.windowHeight:P.contentHeight,P.contentWidth=P.contentWidth>P.windowWidth?P.windowWidth:P.contentWidth)}function _(t){var e=$('<div class="'+O.raw.error+'"><p>Error Loading Resource</p></div>');P.type="element",P.$meta.remove(),P.$image.off(R.namespace),C(e)}function j(t){P.$controls.filter("left"===t.directionX?O.control_next:O.control_previous).trigger(R.click)}function k(t){var e=t[0],i=new Image;return"undefined"!=typeof e.naturalHeight?{naturalHeight:e.naturalHeight,naturalWidth:e.naturalWidth}:"img"===e.tagName.toLowerCase()?(i.src=e.src,{naturalHeight:i.height,naturalWidth:i.width}):!1}var z=t.Plugin("lightbox",{widget:!0,defaults:{customClass:"",extensions:["jpg","sjpg","jpeg","png","gif"],fixed:!1,formatter:p,infinite:!1,labels:{close:"Close",count:"of",next:"Next",previous:"Previous"},margin:50,minHeight:100,minWidth:100,mobile:!1,retina:!1,requestKey:"fs-lightbox",top:0,videoRatio:.5625,videoWidth:600},classes:["loading","animating","fixed","mobile","inline","iframed","open","overlay","close","loading_icon","container","content","image","video","video_wrapper","meta","control","control_previous","control_next","control_disabled","position","position_current","position_total","caption","iframe","error","lock"],events:{open:"open",close:"close",swipe:"swipe"},methods:{_setup:i,_construct:a,_destruct:n,_resize:o,resize:l},utilities:{_initialize:r,close:d}}),T=z.namespace,L=z.defaults,O=z.classes,q=O.raw,R=z.events,A=z.functions,E=t.window,K=t.$window,S=null,N=null,P=null}(jQuery,Formstone);